
 #define i int
 #define n struct n
 #define T , char **C) { return (
 #define x ){ return (
 #define A ->
 #define N n*

n { i c ; N L ; N R ; N U ; N ( * F ) ( N ) ; } ;

 #define F A F
 #define U A U
 #define R A R
 #define L A L
 #define m q = malloc(sizeof * q ) Z F =
 #define e z F ( p ) ) ; }
 #define f e N
 #define g z L Q s f
 #define h ( N p x
 #define H h p L U Q
 #define s R z R = q
 #define t ) ? p : (
 #define z , p
 #define Z , q
 #define Q = p
 #define w ! p U t p U L Q z Q U ,
 #define D W p R U = 0 z R Q R F ( p R ) z R F != E t
 #define W h w
 #define X z = q , 0
 #define V w p F = v z L Q
 #define O m o Z L Q
 #define M m E Z A c =
 #define r Z R Q
 #define u Z U Q
 #define a ) ) ) ? 0 : j ( !
 #define k ( i c x
 #define y 0 ) ; } i

N q ; N
o H z Q L f
v H U z Q L f
K W V L R f
J W V R f
I h V R f



S W w w O L L R r s , O L R r R R g
E D p F Q L A c - p R A c ? J : K f
P D w putchar ( p L R A c ) , m I g
G W M getchar ( ) g
p ;

i j k c ? O U r u U U X : y b k y d k y

 #define d(d) ( ( d a b
 #define b(b) ( ( b a d
 #define E(E) b ( M E u X )

main ( i c T 

 #define I b ( m I u X )
 #define J b ( m J u X )
 #define K b ( m K u X )



 #define P b ( m P u X )
 #define G b ( m G u X )

 #define S b ( m S u X )
 #define B b (S (K S) K)
 #define SS b (B (B S) B)
 #define C b (SS B S (K K))
 #define CC b (B (B C) B)
 #define BB b (CC B (B B B) B)

 #define Y b (S (C B (S I I)) (C B (S I I)))

 #define CI b (C I)

 #define ef E((-1))
 #define sp E(' ')
 #define ob E('(')
 #define cb E(')')
 #define lm E('\\')
 #define nl E('\n')
 #define ht E('\t')
 #define qs E('S')
 #define qk E('K')
 #define qi E('I')

 #define pair b (BB (B (B K)) C CI)
 #define atom b (B K CI)

 #define bind b (CC B B C)

 #define ore b (SS (CI K))
 #define gns b (Y (B (bind G) (CC S (C (ore sp (ore nl ht))) CI)))

 #define pr b (Y (CC C (BB CI (B (BB (bind (P ob)) K)) (SS C (CC C (BB BB bind) K) (C (CC bind) (K (P cb))))) P))

 #define trans b (Y (B (bind gns) (S (BB S (C lm) lam) (C (BB S (C ob) brac) (S (C cb (CI (atom sp))) (S (C ef (CI (atom sp))) (B CI atom)))))))

 #define brac b (S bind (B Y (C (BB B B bind) (S (BB S (BB S (S I)) (CC (BB (B K)) (BB K) pair)) (CC S (CC BB (BB C (C (CI sp)) CI)) pair)))))

 #define lam b (B (bind gns) (C (CC BB bind (B CI)) abs))

 #define abs b (Y (C (BB S (BB C CI) (SS S (BB C (BB B opt)) I)) (CC S (C C (atom qi)) (B (pair (atom qk)) atom))))

 #define make b (B pair (pair (atom qs)))

 #define opt b (S (S I (S (BB (CC B) CI (BB K K make)) (S (BB C (BB C (C (CI qk))) (SS (SS S) (S (BB (BB (S I)) S (BB (BB (CC B) CI) (BB K K) make)) (B (CC B (BB (CC C) (BB (C (CI qk)) (pair (atom qk))) pair)) make)) (B (C (BB B C (C (CI qi)))) make))) make))) (B K make))

(bind (bind trans pr) (P nl) I)

e
